<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v3.8.x plugin-docs plugin-id-default docs-doc-id-operations">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.0">
<title data-rh="true">Operations | Gatekeeper</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://open-policy-agent.github.io/gatekeeper/website/docs/v3.8.x/operations"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v3.8.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v3.8.x"><meta data-rh="true" name="docsearch:version" content="v3.8.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v3.8.x"><meta data-rh="true" property="og:title" content="Operations | Gatekeeper"><meta data-rh="true" name="description" content="Gatekeeper is flexible in how it can be deployed. If desired, core pieces of functionality can be broken"><meta data-rh="true" property="og:description" content="Gatekeeper is flexible in how it can be deployed. If desired, core pieces of functionality can be broken"><link data-rh="true" rel="icon" href="/gatekeeper/website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://open-policy-agent.github.io/gatekeeper/website/docs/v3.8.x/operations"><link data-rh="true" rel="alternate" href="https://open-policy-agent.github.io/gatekeeper/website/docs/v3.8.x/operations" hreflang="en"><link data-rh="true" rel="alternate" href="https://open-policy-agent.github.io/gatekeeper/website/docs/v3.8.x/operations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://PT2IX43ZFM-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-73GS7H3M4S"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-73GS7H3M4S",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Gatekeeper" href="/gatekeeper/website/opensearch.xml"><link rel="stylesheet" href="/gatekeeper/website/assets/css/styles.6513467a.css">
<link rel="preload" href="/gatekeeper/website/assets/js/runtime~main.a118252d.js" as="script">
<link rel="preload" href="/gatekeeper/website/assets/js/main.74750a7d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://open-policy-agent.github.io/gatekeeper/website/docs/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/gatekeeper/website/img/logo.svg" alt="Gatekeeper logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/gatekeeper/website/img/logo.svg" alt="Gatekeeper logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Gatekeeper</b></a><a href="https://open-policy-agent.github.io/gatekeeper-library/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Policy Library<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/gatekeeper/website/docs/v3.8.x/">v3.8.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/gatekeeper/website/docs/next/operations">Next</a></li><li><a class="dropdown__link" href="/gatekeeper/website/docs/operations">v3.11.x</a></li><li><a class="dropdown__link" href="/gatekeeper/website/docs/v3.10.x/operations">v3.10.x</a></li><li><a class="dropdown__link" href="/gatekeeper/website/docs/v3.9.x/operations">v3.9.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/gatekeeper/website/docs/v3.8.x/operations">v3.8.x</a></li><li><a class="dropdown__link" href="/gatekeeper/website/docs/v3.7.x/operations">v3.7.x</a></li><li><a class="dropdown__link" href="/gatekeeper/website/docs/v3.6.x/">v3.6.x</a></li></ul></div><a href="https://github.com/open-policy-agent/gatekeeper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/gatekeeper/website/docs/v3.8.x/">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/install">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/examples">Examples</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/gatekeeper/website/docs/v3.8.x/howto">How to use Gatekeeper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/howto">How to use Gatekeeper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/audit">Audit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/violations">Handling Constraint Violations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/sync">Replicating Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/exempt-namespaces">Exempting Namespaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/library">Policy Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/customize-startup">Customizing Startup Behavior</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/customize-admission">Customizing Admission Behavior</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/debug">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/emergency">Emergency Recovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/vendor-specific">Cloud and Vendor Specific Fixes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/failing-closed">Failing Closed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/mutation">Mutation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/constrainttemplates">Constraint Templates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/externaldata">External Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/gator">The gator CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/workload-resources">Working with Workload Resources</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/gatekeeper/website/docs/v3.8.x/operations">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/operations">Operations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/gatekeeper/website/docs/v3.8.x/developers">Contributing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/developers">Developers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/help">How to contribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/gatekeeper/website/docs/v3.8.x/security">Security</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Gatekeeper<!-- --> <b>v3.8.x</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/gatekeeper/website/docs/operations">latest version</a></b> (<!-- -->v3.11.x<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Architecture</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Operations</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v3.8.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Operations</h1></header><p>Gatekeeper is flexible in how it can be deployed. If desired, core pieces of functionality can be broken
out to be run in different pods. This allows Gatekeeper to accommodate needs like running in a monolithic pod
in order to avoid overhead, or running each operation in a separate pod to make scaling individual operations
easier and to limit the impact of operational issues with any one operation (e.g. if audit is running in its
own pod, audit running out of memory will not affect the validation webhook).</p><p>Gatekeeper achieves this through the concept of <code>Operations</code>, which can be enabled via the <code>--operation</code>
command line flag. To enable multiple operations this flag can be defined multiple times. If no <code>--operation</code>
flag is provided, all functionality will be enabled by default.</p><h1>Operations</h1><p>Below are the operations Gatekeeper supports</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validating-webhook">Validating Webhook<a href="#validating-webhook" class="hash-link" aria-label="Direct link to Validating Webhook" title="Direct link to Validating Webhook">​</a></h2><p><strong>--operation key:</strong> <code>webhook</code></p><p>This operation serves the validating webhook that Kubernetes&#x27; API server calls as part of the admission process.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-behaviors">Required Behaviors<a href="#required-behaviors" class="hash-link" aria-label="Direct link to Required Behaviors" title="Direct link to Required Behaviors">​</a></h3><p>At a high level, this requires:</p><ul><li>Ingesting constraint templates</li><li>Creating CRDs for a corresponding constraint template</li><li>Ingesting constraints</li><li>Reporting the status of ingested constraints/templates</li><li>Watching and syncing resources specified by the <code>Config</code> resource to support referential constraints</li><li>Running the HTTP validating webhook service<ul><li>In addition to validating incoming requests against policy, this webhook also validates incoming Gatekeeper resources</li></ul></li><li>Running the namespace label validating webhook service (required to lock down namespaceSelector-type webhook exemptions)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-required">Permissions Required<a href="#permissions-required" class="hash-link" aria-label="Direct link to Permissions Required" title="Direct link to Permissions Required">​</a></h3><ul><li>The ability to read all <code>ConstraintTemplate</code> objects</li><li>The ability to create CRDs (unfortunately RBAC doesn&#x27;t have the syntax to scope this down to just CRDs in the <code>constraints.gatekeeper.sh</code> group)</li><li>The ability to read all <code>Constraint</code> resources (members of the group <code>constraints.gatekeeper.sh</code>)</li><li>The ability to create <code>ConstraintTemplatePodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>The ability to create <code>ConstraintPodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>The ability to write to the <code>Config</code> object in Gatekeeper&#x27;s namespace</li><li>The ability to read all objects (optionally this can be scoped down to resources listed for syncing in the <code>Config</code>)</li><li>If certificates are managed by Gatekeeper&#x27;s embedded cert controller (which can be disabled), then Gatekeeper will need
write permissions to its <code>ValidatingWebhookConfiguration</code><ul><li>It will also need the ability to write to the webhook secret in Gatekeeper&#x27;s namespace</li></ul></li><li>If you have events enabled, you will need permissions to create events in Gatekeeper&#x27;s namespace</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mutating-webhook">Mutating Webhook<a href="#mutating-webhook" class="hash-link" aria-label="Direct link to Mutating Webhook" title="Direct link to Mutating Webhook">​</a></h2><p><strong>--operation key:</strong> <code>mutation-webhook</code></p><p>This operation serves the mutating webhook that Kubernetes&#x27; API server calls as part of the admission process.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-behaviors-1">Required Behaviors<a href="#required-behaviors-1" class="hash-link" aria-label="Direct link to Required Behaviors" title="Direct link to Required Behaviors">​</a></h3><p>At a high level, this requires:</p><ul><li>Ingesting Mutator objects</li><li>Reporting the status of ingested mutator objects</li><li>Running the HTTP mutating webhook service</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-required-1">Permissions Required<a href="#permissions-required-1" class="hash-link" aria-label="Direct link to Permissions Required" title="Direct link to Permissions Required">​</a></h3><ul><li>The ability to read all objects in the group <code>mutations.gatekeeper.sh</code> (mutators)</li><li>The ability to create <code>MutatorPodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>If certificates are managed by Gatekeeper&#x27;s embedded cert controller (which can be disabled), then Gatekeeper will need
write permissions to its <code>MutatingWebhookConfiguration</code><ul><li>It will also need the ability to write to the webhook secret in Gatekeeper&#x27;s namespace</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="audit">Audit<a href="#audit" class="hash-link" aria-label="Direct link to Audit" title="Direct link to Audit">​</a></h2><p><strong>--operation key:</strong> <code>audit</code></p><p>This operation runs the audit process, which periodically evaluates existing resources against policy, reporting
any violations it discovers. To limit traffic to the API server and to avoid contention writing audit results
to constraints, audit should run as a singleton pod.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-behaviors-2">Required Behaviors<a href="#required-behaviors-2" class="hash-link" aria-label="Direct link to Required Behaviors" title="Direct link to Required Behaviors">​</a></h3><p>At a high level, this requires:</p><ul><li>Listing all objects on the cluster to scan them for violations</li><li>Ingesting constraint templates</li><li>Creating CRDs for a corresponding constraint template</li><li>Ingesting constraints</li><li>Reporting the status of ingested constraints/templates</li><li>Watching and syncing resources specified by the <code>Config</code> resource to support referential constraints</li><li>Writing audit results back to constraints (subject to a cap on # of results per constraint)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-required-2">Permissions Required<a href="#permissions-required-2" class="hash-link" aria-label="Direct link to Permissions Required" title="Direct link to Permissions Required">​</a></h3><ul><li>The ability to read all objects in the cluster (this can be scoped down if you are not interested in auditing/syncing all objects)</li><li>The ability to read all <code>ConstraintTemplate</code> objects</li><li>The ability to create CRDs (unfortunately RBAC doesn&#x27;t have the syntax to scope this down to just CRDs in the <code>constraints.gatekeeper.sh</code> group)</li><li>The ability to write to all <code>Constraint</code> resources (members of the group <code>constraints.gatekeeper.sh</code>)</li><li>The ability to create <code>ConstraintTemplatePodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>The ability to create <code>ConstraintPodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>The ability to write to the <code>Config</code> object in Gatekeeper&#x27;s namespace</li><li>If you have events enabled, you will need permissions to create events in Gatekeeper&#x27;s namespace</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="status">Status<a href="#status" class="hash-link" aria-label="Direct link to Status" title="Direct link to Status">​</a></h2><p><strong>--operation key:</strong> <code>status</code></p><p>Gatekeeper uses an emergent consensus model, where individual pods do not need to talk with each other
in order to provide its functionality. This allows for scalability, but means we should not write status
to resources directly due to the risk of write contention, which could increase network traffic exponentially
relative to the number of pods. Instead, each pod gets its own, private status resource that it alone writes
to. The Status operation aggregates these status resources and writes them to the status field of the appropriate
object for the user to consume. Without this operation, the <code>status</code> field of constraints and constraint templates
would be blank.</p><p>In order to do its job (eliminating write contention) effectively, the Status operation should be run as a
singleton.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-behaviors-3">Required Behaviors<a href="#required-behaviors-3" class="hash-link" aria-label="Direct link to Required Behaviors" title="Direct link to Required Behaviors">​</a></h3><p>At a high level, this requires:</p><ul><li>Reading the Constraint<!-- -->[Template]<!-- -->PodStatus resources</li><li>Writing aggregated results to the <code>status</code> fields of constraints/templates</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-required-3">Permissions Required<a href="#permissions-required-3" class="hash-link" aria-label="Direct link to Permissions Required" title="Direct link to Permissions Required">​</a></h3><ul><li>The ability to write to all <code>ConstraintTemplate</code> objects</li><li>The ability to write to all <code>Constraint</code> resources (members of the group <code>constraints.gatekeeper.sh</code>)</li><li>The ability to read <code>ConstraintTemplatePodStatus</code> objects in Gatekeeper&#x27;s namespace</li><li>The ability to read <code>ConstraintPodStatus</code> objects in Gatekeeper&#x27;s namespace</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mutation-status">Mutation Status<a href="#mutation-status" class="hash-link" aria-label="Direct link to Mutation Status" title="Direct link to Mutation Status">​</a></h2><p><strong>--operation key:</strong> <code>mutation-status</code></p><p>Because users may not want to install mutation CRDs if they do not want to use the feature, and because
trying to watch a Kind that doesn&#x27;t exist would cause errors, Gatekeeper splits mutation status into a
separate operation. It behaves like the Status operation, except it only applies for mutation resources.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-behaviors-4">Required Behaviors<a href="#required-behaviors-4" class="hash-link" aria-label="Direct link to Required Behaviors" title="Direct link to Required Behaviors">​</a></h3><p>At a high level, this requires:</p><ul><li>Reading mutator pod status resources</li><li>Writing aggregated results to the <code>status</code> fields of mutators</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-required-4">Permissions Required<a href="#permissions-required-4" class="hash-link" aria-label="Direct link to Permissions Required" title="Direct link to Permissions Required">​</a></h3><ul><li>The ability to write to all objects in the group <code>mutations.gatekeeper.sh</code> (mutators)</li><li>The ability to read <code>MutatorPodStatus</code> objects in Gatekeeper&#x27;s namespace</li></ul><h1>A Note on Permissions</h1><p>&quot;Create&quot; implies the <code>create</code> and <code>delete</code> permissions in addition to the permissions implied by &quot;Read&quot; and &quot;Write&quot;.</p><p>&quot;Write&quot; implies the <code>update</code> permission in addition to the permissions implied by &quot;Read&quot;.</p><p>&quot;Read&quot; implies the <code>get</code>, <code>list</code>, and <code>watch</code> permissions. In some cases, like scraping audit results,
<code>watch</code> is unnecessary, but does not substantially increase the power delegated to the service account
under the theory that a <code>watch</code> is simply a more efficient version of polling <code>list</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/open-policy-agent/gatekeeper/edit/master/website/versioned_docs/version-v3.8.x/operations.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/gatekeeper/website/docs/v3.8.x/workload-resources"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Working with Workload Resources</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/gatekeeper/website/docs/v3.8.x/developers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Developers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#validating-webhook" class="table-of-contents__link toc-highlight">Validating Webhook</a><ul><li><a href="#required-behaviors" class="table-of-contents__link toc-highlight">Required Behaviors</a></li><li><a href="#permissions-required" class="table-of-contents__link toc-highlight">Permissions Required</a></li></ul></li><li><a href="#mutating-webhook" class="table-of-contents__link toc-highlight">Mutating Webhook</a><ul><li><a href="#required-behaviors-1" class="table-of-contents__link toc-highlight">Required Behaviors</a></li><li><a href="#permissions-required-1" class="table-of-contents__link toc-highlight">Permissions Required</a></li></ul></li><li><a href="#audit" class="table-of-contents__link toc-highlight">Audit</a><ul><li><a href="#required-behaviors-2" class="table-of-contents__link toc-highlight">Required Behaviors</a></li><li><a href="#permissions-required-2" class="table-of-contents__link toc-highlight">Permissions Required</a></li></ul></li><li><a href="#status" class="table-of-contents__link toc-highlight">Status</a><ul><li><a href="#required-behaviors-3" class="table-of-contents__link toc-highlight">Required Behaviors</a></li><li><a href="#permissions-required-3" class="table-of-contents__link toc-highlight">Permissions Required</a></li></ul></li><li><a href="#mutation-status" class="table-of-contents__link toc-highlight">Mutation Status</a><ul><li><a href="#required-behaviors-4" class="table-of-contents__link toc-highlight">Required Behaviors</a></li><li><a href="#permissions-required-4" class="table-of-contents__link toc-highlight">Permissions Required</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/open-policy-agent/gatekeeper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://slack.openpolicyagent.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack (#opa-gatekeeper)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.google.com/document/d/1A1-Q-1OMw3QODs1wT6eqfLTagcGmgzAJAjJihiO3T48/edit)" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meetings<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/gatekeeper/website/assets/js/runtime~main.a118252d.js"></script>
<script src="/gatekeeper/website/assets/js/main.74750a7d.js"></script>
</body>
</html>